var se=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function ie(h){return h&&h.__esModule&&Object.prototype.hasOwnProperty.call(h,"default")?h.default:h}var L={exports:{}};(function(h,ae){(function(P,S){h.exports=S()})(se,function(){function P(t,n=document){return typeof t=="string"?Array.from(n.querySelectorAll(t)):t instanceof Element?[t]:t instanceof NodeList?Array.from(t):t instanceof Array?t:[]}function S(t){const n=document.createElement("div");n.className=`scrollama__debug-step ${t}`,n.style.position="fixed",n.style.left="0",n.style.width="100%",n.style.zIndex="9999",n.style.borderTop="2px solid black",n.style.borderBottom="2px solid black";const o=document.createElement("p");return o.style.position="absolute",o.style.left="0",o.style.height="1px",o.style.width="100%",o.style.borderTop="1px dashed black",n.appendChild(o),document.body.appendChild(n),n}function Y({id:t,step:n,marginTop:o}){const{index:l,height:u}=n,p=`scrollama__debug-step--${t}-${l}`;let d=document.querySelector(`.${p}`);d||(d=S(p)),d.style.top=`${o*-1}px`,d.style.height=`${u}px`,d.querySelector("p").style.top=`${u/2}px`}function D(){const t="abcdefghijklmnopqrstuvwxyz",n=Date.now(),o=[];for(let l=0;l<6;l+=1){const u=t[Math.floor(Math.random()*t.length)];o.push(u)}return`${o.join("")}${n}`}function E(t){console.error(`scrollama error: ${t}`)}function v(t){return+t.getAttribute("data-scrollama-index")}function G(t,n){const o=Math.ceil(t/n),l=[],u=1/o;for(let p=0;p<o+1;p+=1)l.push(p*u);return l}function k(t){if(typeof t=="string"&&t.indexOf("px")>0){const n=+t.replace("px","");return isNaN(n)?(err("offset value must be in 'px' format. Fallback to 0.5."),{format:"percent",value:.5}):{format:"pixels",value:n}}else if(typeof t=="number"||!isNaN(+t))return t>1&&err("offset value is greater than 1. Fallback to 1."),t<0&&err("offset value is lower than 0. Fallback to 0."),{format:"percent",value:Math.min(Math.max(0,t),1)};return null}function J(t){t.forEach(n=>n.node.setAttribute("data-scrollama-index",n.index))}function K(t){const{top:n}=t.getBoundingClientRect(),o=window.pageYOffset,l=document.body.clientTop||0;return n+o-l}let m,$,c;function _(t){const n=t?t.scrollTop:window.pageYOffset;m!==n&&(m=n,m>$?c="down":m<$&&(c="up"),$=m)}function Q(t){m=0,$=0,document.addEventListener("scroll",()=>_(t))}function U(){let t={},n=D(),o=[],l,u,p,d=0,q=!1,T=!1,z=!1,I=!1,j=[];function C(){t={stepEnter:()=>{},stepExit:()=>{},stepProgress:()=>{}},j=[]}function M(e){e&&!q&&N(),!e&&q&&H(),q=e}function A(e,s){const r=v(e),i=o[r];s!==void 0&&(i.progress=s);const a={element:e,index:r,progress:s,direction:c};i.state==="enter"&&t.stepProgress(a)}function V(e,s=!0){const r=v(e),i=o[r],a={element:e,index:r,direction:c};i.direction=c,i.state="enter",j[r]||t.stepEnter(a),I&&(j[r]=!0)}function W(e,s=!0){const r=v(e),i=o[r];if(!i.state)return!1;const a={element:e,index:r,direction:c};T&&(c==="down"&&i.progress<1?A(e,1):c==="up"&&i.progress>0&&A(e,0)),i.direction=c,i.state="exit",t.stepExit(a)}function X([e]){const s=v(e.target),r=o[s],i=e.target.offsetHeight;i!==r.height&&(r.height=i,F(r),B(r),R(r))}function Z([e]){_(u);const{isIntersecting:s,target:r}=e;s?V(r):W(r)}function ee([e]){const s=v(e.target),r=o[s],{isIntersecting:i,intersectionRatio:a,target:g}=e;i&&r.state==="enter"&&A(g,a)}function F({observers:e}){Object.keys(e).map(s=>{e[s].disconnect()})}function H(){o.forEach(F)}function R(e){const s=new ResizeObserver(X);s.observe(e.node),e.observers.resize=s}function te(){o.forEach(R)}function B(e){const s=window.innerHeight,r=e.offset||l,i=r.format==="pixels"?1:s,a=r.value*i,g=e.height/2-a,w=e.height/2-(s-a),x={rootMargin:`${g}px 0px ${w}px 0px`,threshold:.5,root:p},b=new IntersectionObserver(Z,x);b.observe(e.node),e.observers.step=b,z&&Y({id:n,step:e,marginTop:g})}function ne(){o.forEach(B)}function oe(e){const s=window.innerHeight,r=e.offset||l,i=r.format==="pixels"?1:s,a=r.value*i,g=-a+e.height,w=a-s,x=`${g}px 0px ${w}px 0px`,b=G(e.height,d),y={rootMargin:x,threshold:b},O=new IntersectionObserver(ee,y);O.observe(e.node),e.observers.progress=O}function re(){o.forEach(oe)}function N(){H(),te(),ne(),T&&re()}const f={};return f.setup=({step:e,parent:s,offset:r=.5,threshold:i=4,progress:a=!1,once:g=!1,debug:w=!1,container:x=void 0,root:b=null})=>(Q(x),o=P(e,s).map((y,O)=>({index:O,direction:void 0,height:y.offsetHeight,node:y,observers:{},offset:k(y.dataset.offset),top:K(y),progress:0,state:void 0})),o.length?(T=a,I=g,z=w,d=Math.max(1,+i),l=k(r),u=x,p=b,C(),J(o),M(!0),f):(E("no step elements"),f)),f.enable=()=>(M(!0),f),f.disable=()=>(M(!1),f),f.destroy=()=>(M(!1),C(),f),f.resize=()=>(N(),f),f.offset=e=>e==null?l.value:(l=k(e),N(),f),f.onStepEnter=e=>(typeof e=="function"?t.stepEnter=e:E("onStepEnter requires a function"),f),f.onStepExit=e=>(typeof e=="function"?t.stepExit=e:E("onStepExit requires a function"),f),f.onStepProgress=e=>(typeof e=="function"?t.stepProgress=e:E("onStepProgress requires a function"),f),f}return U})})(L);var fe=L.exports,le=ie(fe);export{le as default};
